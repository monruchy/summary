# Recursion

* _เหมือนกันทั้ง C และ C++_

* Recursive Function คือฟังก์ชันที่มีการเรียกฟังก์ชันที่มีลักษณะเหมือนกันตนเอง โดยทั่วไปมีลักษณะสองอย่าง
* Base Case คือกรณีพื้นฐานที่ฟังก์ชันสามารถคืนค่าได้เลย (ถ้ามี) มีไว้หยุดการ Recursion
* ส่วนกรณีที่จำเป็นต้องเรียกฟังก์ชันตนเอง เพื่อนำมาประมวลผล ก่อนจะหาค่าได้
* เมื่อเรียกตนเองไปแล้ว ฟังก์ชันที่ถูกเรียกนั้นอาจจะต้องเรียกตนเองซ้ำอีก ไปเรื่อยๆ จนกว่าจะถึง Base Case แล้วจึงค่อยๆ คืนค่ากลับมา

ตัวอย่าง
```c
int factorial(int n)
{
    if (n == 0)
        return 1;

    // ตรงนี้อาจมี else ก็ได้ แต่ไม่จำเป็น เพราะหาก if เป็นจริง จะ return ก่อนถึงบรรทัดนี้
    return n * factorial(n - 1);
}
```

* จากตัวอย่าง สังเกตว่า `factorial` เป็นฟังก์ชันที่มี Base Case คือ `n` เป็น 0 ซึ่งจะคืนค่าเป็น 1 ทันที
* ส่วนการเรียกตนเองนั้น จะเกิดขึ้นเมื่อ `n` มีค่ามากกว่า 0 โดยจะคืนค่า `n` คูณกับ `factorial(n - 1)`

* ตัวอย่างการทำงาน เมื่อเรียก `factorial(4)`
  - 4 ไม่ใช่ 0 หรือ 1 ดังนั้น `factorial(4)` จะคืนค่า `4 * factorial(3)`
  - จำเป็นต้องคำนวณ `factorial(3)` ก่อน ซึ่งก็คือ `3 * factorial(2)`
  - เช่นเดียวกัน `factorial(2)` ก็คือ `2 * factorial(1)`
  - เช่นเดียวกับ `factorial(1)` ก็คือ `1 * factorial(0)`
  - เนื่องจาก `n` มีค่าเป็น 0 `factorial(0)` จึงคืนเลข 1 ให้ `factorial(1)` ทันที
  - `factorial(1)` ก็จะเขียนแทนเป็น `1 * 1` (1) ได้
  - `factorial(2)` ก็จะเขียนแทนเป็น `2 * 1` (2) ได้
  - `factorial(3)` ก็จะเขียนแทนเป็น `3 * 2` (6) ได้
  - `factorial(4)` ก็จะเขียนแทนเป็น `4 * 6` (24) ได้
  - ดังนั้น จะได้ว่า `factorial(4)` เท่ากับ 24

ตัวอย่าง
```c
int fibbo(int n)
{
    // base case: fibbo(0) = 0, fibbo(1) = 1
    if (n <= 1)
        return n;
    
    // นอกเหนือจากนั้น คำตอบคือผลบวกของเลข fibonacci สองตัวหน้า
    return fibbo(n - 1) + fibbo(n - 2);
}
```

* ตัวอย่างการทำงานเมื่อเรียก `fibbo(3)`
  - `fibbo(3)` มีค่าเท่ากับ `fibbo(2) + fibbo(1)`
  - ต้องหา `fibbo(2)` ซึ่งมีค่าเท่ากับ `fibbo(1) + fibbo(0)`
  - `fibbo(1)` เป็น base case มีค่าเท่ากับ 1
  - `fibbo(2)` จะเขียนแทนได้เป็น `1 + fibbo(0)` ยังต้องคิด `fibbo(0)` อยู่
  - `fibbo(0)` เป็น base case มีค่าเท่ากับ 0
  - `fibbo(2)` ก็จะเขียนแทนได้เป็น `1 + 0` (1)
  - `fibbo(3)` จะเขียนแทนได้เป็น `1 + fibbo(1)` แล้วก็เขียนแทนได้เป็น `1 + 1` (2)
  - ดังนั้น จะได้ว่า `fibbo(3)` เท่ากับ 2

## Tail Recursion

* จะสังเกตว่าฟังก์ชันทั้งสองที่ยกตัวอย่างมา จำเป็นจะต้องรอค่าจากฟังก์ชันเดียวกันก่อน แล้วนำมาคำนวณ (บวก/คูณ) ก่อนที่จะคืนค่ากลับไปได้
* Tail Recursion คือการเรียกตนเองซ้ำโดยไม่จำเป็นต้องทำงานในฟังก์ชันเดิมเพิ่มเติมอะไรอีก

ตัวอย่าง
```c
void printBackward(int n)
{
    if (n == 0)
        return; // ออกฟังก์ชันโดยไม่ทำอะไรทั้งสิ้น

    printf("%d\n", n);
    printBackward(n - 1);
}
```

* ฟังก์ชันตัวอย่าง จะทำการปรินท์เลขตั้งแต่ n, n - 1, n - 2, ..., 1 ตัวละบรรทัด
* สังเกตได้ว่า ในการเรียก `printBackward` ซ้ำ เราไม่จำเป็นต้องสนใจสิ่งที่เกิดขึ้นภายในฟังก์ชันเดิมอีก เพราะไม่จำเป็นต้องคำนวณ หรือดำเนินการใดๆต่อทั้งสิ้น
* ประโยชน์ของ Tail Recursion คืออาจทำให้โปรแกรมมีประสิทธิภาพมากขึ้นเฉพาะบาง Compiler เพราะไม่จำเป็นต้องจดจำสถานะของฟังก์ชันเดิมไว้เพื่อดำเนินการต่อ